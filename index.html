<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Arthur & Jojo - Site Officiel</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.30.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.30.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.30.0/firebase-database-compat.js"></script>

<style>
body {
    margin: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(120deg,#111,#222,#111);
    color: #fff;
    cursor: url('https://cdn.iconscout.com/icon/free/png-256/magic-wand-107967.png'), auto;
}
header {
    padding: 1rem;
    text-align: center;
    background: linear-gradient(90deg,#222,#444);
    box-shadow: 0 4px 10px rgba(0,0,0,0.5);
}
h1 { font-size: 2.5rem; }
nav { 
    display: flex; 
    justify-content: flex-end; 
    background:#222; 
    padding:0.5rem 1rem;
}
nav button {
    background: linear-gradient(135deg,#444,#666);
    border:none;
    color:#fff;
    padding:0.6rem 1rem;
    margin-left:0.5rem;
    border-radius:10px;
    cursor:pointer;
    transition:0.3s;
}
nav button:hover { transform: scale(1.1); background: linear-gradient(135deg,#666,#888); }

.container { max-width:1200px; margin:2rem auto; padding:1rem; }
section { margin-bottom:2rem; background:#1a1a1a; border-radius:10px; padding:1rem; box-shadow:0 0 10px rgba(0,0,0,0.5);}
button.styled { background:linear-gradient(135deg,#555,#777); border:none; padding:0.8rem 1.2rem; border-radius:15px; cursor:pointer; color:#fff; margin-top:0.5rem; transition:0.3s; }
button.styled:hover { transform:scale(1.05); background:linear-gradient(135deg,#777,#999); }

.admin-panel {
    display:none;
    position:fixed;
    top:5%; left:5%; right:5%; bottom:5%;
    background:linear-gradient(135deg,#111,#333);
    border:2px solid #444;
    border-radius:15px;
    overflow:auto;
    padding:1rem;
    z-index:1000;
}

.tabs { display:flex; margin-bottom:1rem; }
.tab { flex:1; text-align:center; padding:0.5rem; cursor:pointer; border-bottom:2px solid #444; transition:0.3s; }
.tab.active { border-bottom:3px solid #ffcc00; font-weight:bold; }

.tab-content { display:none; }
.tab-content.active { display:block; }

.ticket { background:#222; padding:0.8rem; margin-bottom:0.5rem; border-radius:10px; }
.ticket .messages { max-height:200px; overflow-y:auto; margin-top:0.5rem; }
.ticket input { width:80%; padding:0.5rem; border-radius:5px; border:none; margin-right:0.5rem; }
.ticket button { padding:0.5rem 1rem; border:none; border-radius:5px; cursor:pointer; background:#ffcc00; color:#000; }

.annonce { background:#333; padding:0.8rem; margin-bottom:0.5rem; border-radius:10px; }

.dark-mode { background: linear-gradient(120deg,#111,#222,#111); color:#fff; }
.light-mode { background: linear-gradient(120deg,#eee,#ccc,#eee); color:#000; }
</style>
</head>
<body>

<header>
    <h1>Arthur & Jojo üé¨</h1>
</header>

<nav>
    <button id="menuBtn">‚ò∞ Se connecter</button>
</nav>

<div class="container">

    <section id="annonces-section">
        <h2>üì¢ Annonces</h2>
        <div id="annonces"></div>
        <button class="styled" id="newAnnonceBtn">‚ûï Ajouter Annonce</button>
    </section>

    <section id="tickets-section">
        <h2>üé´ Tickets</h2>
        <div id="tickets"></div>
        <button class="styled" id="newTicketBtn">‚ûï Ouvrir un Ticket</button>
    </section>

</div>

<div class="admin-panel" id="adminPanel">
    <div class="tabs">
        <div class="tab active" data-tab="annonces">Annonces</div>
        <div class="tab" data-tab="tickets">Tickets</div>
    </div>
    <div class="tab-content active" id="admin-annonces">
        <h3>Gestion Annonces</h3>
        <div id="adminAnnonces"></div>
        <input type="text" id="annonceInput" placeholder="Nouvelle annonce...">
        <button onclick="addAnnonce()">Ajouter</button>
    </div>
    <div class="tab-content" id="admin-tickets">
        <h3>Gestion Tickets</h3>
        <div id="adminTickets"></div>
    </div>
    <button onclick="closeAdminPanel()" class="styled">‚ùå Fermer</button>
</div>

<script>
// ---------------- Firebase Setup ----------------
const firebaseConfig = {
    apiKey: "VOTRE_API_KEY",
    authDomain: "VOTRE_PROJECT.firebaseapp.com",
    databaseURL: "https://VOTRE_PROJECT.firebaseio.com",
    projectId: "VOTRE_PROJECT",
    storageBucket: "VOTRE_PROJECT.appspot.com",
    messagingSenderId: "VOTRE_SENDER",
    appId: "VOTRE_APPID"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.database();

// ---------------- Mode Admin ----------------
let isAdmin = false;

function openAdminPanel() { document.getElementById('adminPanel').style.display='block'; }
function closeAdminPanel() { document.getElementById('adminPanel').style.display='none'; }

// ---------------- Tabs Admin ----------------
document.querySelectorAll('.tab').forEach(tab=>{
    tab.addEventListener('click',()=>{
        document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c=>c.classList.remove('active'));
        tab.classList.add('active');
        document.getElementById('admin-'+tab.dataset.tab).classList.add('active');
    });
});

// ---------------- Annonces ----------------
function addAnnonce() {
    if(!isAdmin) return alert('‚ùå Admin requis');
    const value = document.getElementById('annonceInput').value;
    if(!value) return;
    const key = db.ref('annonces').push().key;
    db.ref('annonces/'+key).set({ text:value });
    document.getElementById('annonceInput').value='';
}

db.ref('annonces').on('value', snapshot=>{
    const annonces = snapshot.val() || {};
    document.getElementById('annonces').innerHTML='';
    document.getElementById('adminAnnonces').innerHTML='';
    for(let key in annonces){
        let div = document.createElement('div');
        div.className='annonce';
        div.innerText=annonces[key].text;
        document.getElementById('annonces').appendChild(div);

        if(isAdmin){
            let divAdmin = div.cloneNode(true);
            let btnDel = document.createElement('button'); btnDel.innerText='‚ùå'; btnDel.onclick=()=>db.ref('annonces/'+key).remove();
            divAdmin.appendChild(btnDel);
            document.getElementById('adminAnnonces').appendChild(divAdmin);
        }
    }
});

// ---------------- Tickets ----------------
function newTicket() {
    const uid = auth.currentUser.uid;
    const key = db.ref('tickets').push().key;
    db.ref('tickets/'+key).set({ user: uid, messages: {} });
}

document.getElementById('newTicketBtn').addEventListener('click', newTicket);

db.ref('tickets').on('value', snapshot=>{
    const tickets = snapshot.val()||{};
    const ticketsDiv = document.getElementById('tickets');
    ticketsDiv.innerHTML='';
    const adminTicketsDiv = document.getElementById('adminTickets');
    adminTicketsDiv.innerHTML='';
    for(let key in tickets){
        const t = tickets[key];
        if(t.user===auth.currentUser?.uid || isAdmin){
            let div = document.createElement('div'); div.className='ticket';
            div.innerHTML=`<strong>Ticket ID: ${key}</strong><div class="messages"></div><input placeholder="Message..."><button>Envoyer</button>`;
            const messagesDiv = div.querySelector('.messages');
            for(let m in t.messages){ messagesDiv.innerHTML+=`<div>${t.messages[m].text}</div>`; }

            const input = div.querySelector('input');
            const btn = div.querySelector('button');
            btn.onclick=()=>{
                if(!input.value) return;
                db.ref('tickets/'+key+'/messages').push({ text: input.value, from: auth.currentUser.displayName||'Utilisateur' });
                input.value='';
            };
            ticketsDiv.appendChild(div);

            if(isAdmin){ adminTicketsDiv.appendChild(div.cloneNode(true)); }
        }
    }
});

// ---------------- Connexion Google ----------------
document.getElementById('menuBtn').addEventListener('click',()=>{
    const choix = prompt("Tapez 'admin' pour acc√®s admin ou 'user' pour connexion Google");
    if(choix==='admin'){
        const code = prompt("Entrez le code admin:");
        if(code==='2516'){ isAdmin=true; openAdminPanel(); alert("‚úÖ Acc√®s admin activ√©"); }
    } else if(choix==='user'){
        const provider = new firebase.auth.GoogleAuthProvider();
        auth.signInWithPopup(provider).then(result=>{
            alert('‚úÖ Connect√© en tant que '+result.user.displayName);
        });
    }
});
</script>
</body>
</html>
